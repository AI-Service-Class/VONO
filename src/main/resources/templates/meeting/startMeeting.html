<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="~{layout/defaultNoChat}">
<th:block layout:fragment="content">
	<!-- jQuery library -->
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<link th:href="@{css/sb-admin-2.min.css}" rel="stylesheet">





	<input type="button" name="record_start" id="record_start" value="�끃�쓬 �떆�옉" >
	<input type="button" name="record_pause" id="record_pause" value="�끃�쓬 以묒�" disabled="disabled" style="background-color: #ff6666 ">
	<input type="button" name="record_restart" id="record_restart" value="�끃�쓬 �옱�떆�옉" disabled="disabled" style="background-color: #ff6666 ">
	<input type="button" name="record_end" id="record_end" value="�끃�쓬 �셿猷�" disabled="disabled" style="background-color: #ff6666 ">
	
	<form name="actionForm" id="actionForm" hidden="" action="endRecording">
		<input type="hidden" id="inputHidden" name="inputHidden" value="">
		<input th:value="${name}" id="mt_name" name="mt_name" >
		<input th:value="${date}" id="mt_date" name="mt_date">
		<input th:value="${participant}" id="mt_participant" name="mt_participant">
		<input th:value="${content}" id="mt_content" name="mt_content">
	</form>
	
	
	
	
	
	
	
	<table style="border: 1px;" class="table table-hover table-white"
		id="speakTable">
		<thead>
			<tr>
				<th style="width: 80px">�떆媛�</th>
				<th style="width: 80px">�솕�옄</th>
				<th>�궡�슜</th>
			</tr>
		</thead>
	</table>

<script type="text/javascript">
$(document).ready(function(){
	var temp='';
	
	$("#record_start").click(function(){
		$("#record_start").val("�끃�쓬以�");
		$("#record_start").attr("disabled","disabled");
		$("#record_start").css({ background:"#ff6666" , color:"#ffffff" });
		$("#record_pause").attr("disabled",false);
		$("#record_pause").css({ background:"#56BAED" , color:"#ffffff" });
		$("#record_end").attr("disabled",false);
		$("#record_end").css({ background:"#56BAED" , color:"#ffffff" });
		$.ajax ({
			url : "startRecording",
			type : "post",
			success : function(html){
			}
		});
	});
	timer = setInterval( function () {
	    $.ajax ({
			url : "infiniteReq",
			type : "get",
			success : function (html) {
	        	if(temp != html.content){
	        		temp=html.content;
		        	if(html.length != 0){
		        		var htm = '';
		        		console.log(html.content);
		        		
		        		htm += '<tr>';
		        		htm += '<td>'+html.time+'\t'+'</td>';
		        		htm += '<td>'+'speaker'+html.speaker+'</td>';
		        		htm += '<td>'+html.content+'</td>';
		        		
		        		htm += '</tr>';
		        		htm += '<tr>';
		        		htm += '<td colspan="3"><input  type="text" style="height:5px; width:2000px; text-align:left;"></textarea></td>';
		        		htm += '</tr>';
		        		
		        		$("#speakTable").append(htm);
					} 
				}
			} 
		});
	}, 500);
});

$("#record_pause").click(function(){
		$.ajax ({
			url : "pauseRecording",
			type : "post",
			success : function(html){
				$("#record_pause").attr("disabled",true);
				$("#record_pause").css({ background:"#ff6666" , color:"#ffffff" });
				$("#record_restart").attr("disabled",false);
				$("#record_restart").css({ background:"#56BAED" , color:"#ffffff" });
			}
		});
});

$("#record_restart").click(function(){
	$.ajax ({
		url : "restartRecording",
		type : "post",
		success : function(html){
			$("#record_pause").attr("disabled",false);
			$("#record_pause").css({ background:"#56BAED" , color:"#ffffff" });
			$("#record_restart").attr("disabled",true);
			$("#record_restart").css({ background:"#ff6666" , color:"#ffffff" });
		}
	});
});

$("#record_end").click(function(){
	var memo;
	var dataArrayToSend = [];
	var meetingId=$("#meetingId").val();

	$("#speakTable tr").each(function(){
	var len = $(this).find("td").length;
		if(len==1){
			var memostr = $(this).find("td").eq(0).find('input[type="text"]').val();
			if(memostr.length != 0){
				memo = {memo:memostr};
				dataArrayToSend.push(memo);
				
			}
		}
	});
	
	var list={list:dataArrayToSend};
	
	var formObj = $("form[name='actionForm']");
	
	$("#inputHidden").attr("value",JSON.stringify(list));
	formObj.attr("method", "post");
	formObj.submit();

	
	
	
	//location.href("")
	/* $.ajax ({
		url : "endRecording",
		type : "post",
		success : function(html){
			$("#record_pause").attr("disabled",true);
			$("#record_pause").css({ background:"#ff6666" , color:"#ffffff" });
			$("#record_restart").attr("disabled",true);
			$("#record_restart").css({ background:"#ff6666" , color:"#ffffff" });
			$("#record_end").attr("disabled",true);
			$("#record_end").css({ background:"#ff6666" , color:"#ffffff" });
			alert("�끃�쓬�쓣 醫낅즺�빀�땲�떎(�쁽�옱 �떆媛꾩쑝濡� �뿊���뙆�씪 �깮�꽦�맖)");
			
		}
	}); */
});

</script>

</th:block>
</html>